<!DOCTYPE html>
<html>

  <head>
    <meta charset="UTF-8">
    <title>文章栏目管理</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="datatable/datatable.css" rel="stylesheet">

  
  </head>

  <body>
  	<div class="layui-btn-group demoTable">
  <button class="layui-btn" data-type="getCheckData" onclick="getdata()">获取选中行数据</button>
  <button class="layui-btn" data-type="getCheckLength">获取选中数目</button>
  <button class="layui-btn" data-type="isAll">验证是否全选</button>
</div>
    <table class="table-box table-sort" id="article" class="layui-table" lay-data="{id: 'idTest'}" lay-filter="demo">
      <thead>
        <tr>
          <th class="sorting_desabled">选择</th>
          <th>ID</th>
          <th>文章类别</th>
          <th>文章名称</th>
          <th>文章内容</th>
          <th>发布时间</th>
          <th>状态</th>
          <th>操作</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
    <script src="layui/layui.js"></script>
    <script>
      layui.config({
        base: 'datatable/' //自定义layui组件的目录
      }).extend({ //设定组件别名
        datatable: 'datatable',
      });
      layui.use(['jquery', 'datatable'], function() {
     var $ = layui.jquery;
        $(function() {
          /**
           * 渲染数据
           */
          var lang = {
            "sProcessing": "处理中...",
            "sLengthMenu": "每页 _MENU_ 项",
            "sZeroRecords": "没有匹配结果",
            "sInfo": "当前显示第 _START_ 至 _END_ 项，共 _TOTAL_ 项。",
            "sInfoEmpty": "当前显示第 0 至 0 项，共 0 项",
            "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
            "sInfoPostFix": "",
            "sSearch": "本地搜索：",
            "sUrl": "",
            "sEmptyTable": "暂无数据",
            "sLoadingRecords": "载入中...",
            "sInfoThousands": ",",
            "oPaginate": {
              "sFirst": "首页",
              "sPrevious": "上页",
              "sNext": "下页",
              "sLast": "末页",
              "sJump": "跳转"
            },
            "oAria": {
              "sSortAscending": ": 以升序排列此列",
              "sSortDescending": ": 以降序排列此列"
            }
          };
          $('#article').dataTable({
            "language": lang, //提示信息
            "autoWidth": false, //自适应宽度，
            "lengthMenu": [15, 30, 50],
            "stripeClasses": ["odd", "even"], //为奇偶行加上样式，兼容不支持CSS伪类的场合
            "searching": true, //是否允许Datatables开启本地搜索
            "paging": true, //是否开启本地分页
            "lengthChange": true, //是否允许产品改变表格每页显示的记录数
            "info": true, //控制是否显示表格左下角的信息
            //跟数组下标一样，第一列从0开始，这里表格初始化时，第四列默认降序
            "order": [1, 'desc'], //asc升序   desc降序 
            "aoColumnDefs": [{
              "orderable": false,
              "aTargets": [0, 4, 7] // 指定列不参与排序
            }],
            "deferRender": true, //延迟渲染
            "ajax": "article.json", //数据的路径
            "columns": [{ //定义列
              "data": function(obj) {
                return '<input type="checkbox" name="article-list" data-id=' + obj.id + '>';
              }
            }, {
              "data": "id",
                "className":"good_id"
            }, {
              "data": "articleSorts"
            }, {
              "data": "articleTitle"
            }, {
              "data": "articleContents",
              "className": "oneline",
            }, {
              "data": function(obj) {
                return replaceTime(obj.releaseTime / 1000);
              }
            }, {
              "data": function(obj) {
                if(obj.releaseStatus) {
                  return '<span class="label label-success radius">正常发布</span>';
                } else {
                  return '<span class="label label-default radius">暂停发布</span>';
                }
              },
              "className": "td-status"
            }, {
              "data": function(obj) {
                if(obj.releaseStatus) {
                  return '<span title="暂停发布" class="handle-btn handle-btn-stop"><i class="linyer icon-zanting"></i></span><span title="编辑" class="handle-btn handle-btn-edit"><i class="linyer icon-edit"></i></span><span title="删除" class="handle-btn handle-btn-delect"><i class="linyer icon-delect"></i></span>';
                } else {
                  return '<span title="正常发布" class="handle-btn handle-btn-run"><i class="linyer icon-qiyong"></i></span><span title="编辑" class="handle-btn handle-btn-edit"><i class="linyer icon-edit"></i></span><span title="删除" class="handle-btn handle-btn-delect"><i class="linyer icon-delect"></i></span>';
                }
              },
              "className": "td-handle"
            }]
          });
        });
      })

      function replaceTime(nS) {
        return new Date(parseInt(nS) * 1000).toLocaleString().replace(/:\d{1,2}$/, ' ');
      }

      //主动加载jquery模块
      layui.use(['jquery', 'layer'], function() {
          var $ = layui.$ //重点处
              , layer = layui.layer;

          function getdata(){
              var selectedData = [];
              $(":checkbox:checked").each(function(){
                  var tablerow = $(this).parent("tr");
                  var id = tablerow.find(".good_id").val();
                  var contents= tablerow.find(".online").val();

                  selectedData.push({ID:id,Contents:contents});
              });
              alert(parseJSON(selectedData));
          }
      });

    </script>
  </body>

</html>